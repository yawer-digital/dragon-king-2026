<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>Ultra Slot Pro</title>

    <style>
body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background: url("https://raw.githubusercontent.com/yawer-digital/games/refs/heads/main/bgs.png") center/cover no-repeat fixed;
  font-family:Arial;
}

/* üì± Container */
.slot{
  width:100%;
  max-width:480px;
  margin:30px;
  background:#a82400;
  padding:14px;
  border-radius:22px;
  box-shadow:0 0 40px #000;
  color:#fff;
}

/* Top */
.top{
  display:flex;
  justify-content:space-between;
  background:#6b0d00;
  padding:10px;
  border-radius:14px;
  font-size:16px;
}

/* BET PANEL */
.bet-panel{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:14px;
  background:#6b0d00;
  padding:10px;
  border-radius:14px;
  margin-top:10px;
}

.bet-panel button{
  width:44px;
  height:44px;
  border:none;
  font-size:24px;
  background:#6b0d00;
}

.bet-value{
  font-size:20px;
  font-weight:bold;
}

/* üé∞ Reels */
.reels{
  display:flex;
  gap:6px;
  margin:18px 0;
  justify-content:center;
}

.reel{
  width:68px;
  height:204px;
  background:#6b0d00;
  border-radius:12px;
  overflow:hidden;
  position:relative;
}

.track{
  position:absolute;
  width:100%;
}

.symbol{
  height:68px;
  display:flex;
  align-items:center;
  justify-content:center;
}

.symbol img{
  width:54px;
  height:54px;
  object-fit:contain;
}

/* Spin */
.spin{
  animation: spinFast .12s linear infinite;
  filter: blur(1.5px);
}

@keyframes spinFast{
  from{transform:translateY(0)}
  to{transform:translateY(-68px)}
}

/* Stop */
.stop{
  animation: stopBounce .35s cubic-bezier(.2,.8,.2,1);
}

@keyframes stopBounce{
  0%{transform:translateY(-25px)}
  60%{transform:translateY(6px)}
  100%{transform:translateY(0)}
}

/* Win */
.win{
  background:linear-gradient(135deg,#ffe066,#ffb703);
  animation: glow 1s infinite alternate;
}

@keyframes glow{
  from{box-shadow:0 0 5px gold}
  to{box-shadow:0 0 14px gold}
}

/* SPIN BUTTON */
.spin-btn{
  width:100%;
  padding:16px;
  font-size:24px;
  background:linear-gradient(#ff3d00,#ff9100);
  border:none;
  border-radius:22px;
  color:white;
}

/* üì± Extra small phones */
@media(max-width:360px){
  .reel{ width:60px; height:180px }
  .symbol{ height:60px }
  .symbol img{ width:46px; height:46px }
  .top{ font-size:14px }
}

/* üîù ICON BAR */
.icon-bar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:8px;
}

.icon-bar button{
  background:#6b0d00;
  border:none;
  width:34px;
  height:34px;
  border-radius:50%;
  display:flex;
  justify-content:center;
  align-items:center;
}

.icon-bar img{
  width:22px;
  filter:invert(1);
}

/* ‚ÑπÔ∏è INFO MODAL */
#infoBox{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:999;
}

#infoContent{
  background:#6b0d00;
  color:#fff;
  padding:20px;
  width:90%;
  max-width:360px;
  border-radius:18px;
  text-align:center;
}

#infoContent h2{
  margin-top:0;
}

#infoContent button{
  margin-top:12px;
  padding:10px 18px;
  border:none;
  background:#6b0d00;
  border-radius:14px;
  color:#fff;
  font-size:16px;
}

/* ‚ú® WIN EFFECT */
#winEffect{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  background:rgba(0,0,0,.6);
  z-index:999;
  opacity:0;
  pointer-events:none;
}

#winEffect.show{
  animation: winFade 1.6s ease forwards;
}

#winEffect img{
  width:180px;
  animation: winPop 1.2s cubic-bezier(.2,.8,.2,1);
}

@keyframes winPop{
  0%{transform:scale(.2); opacity:0}
  60%{transform:scale(1.2); opacity:1}
  100%{transform:scale(1)}
}

@keyframes winFade{
  0%{opacity:0}
  20%{opacity:1}
  80%{opacity:1}
  100%{opacity:0}
}
</style>
</head>

<body>



<div class="slot">
    <!-- TOP ICON BAR -->
    <div class="icon-bar">
        <button onclick="toggleMusic()">
            <img id="musicIcon"
                 src="https://cdn-icons-png.flaticon.com/512/727/727269.png">
        </button>

        <button onclick="openInfo()">
            <img
                    src="https://raw.githubusercontent.com/yawer-digital/games/refs/heads/main/sv1.png">
        </button>
    </div>
    <div class="bet-panel">
        <img src="https://raw.githubusercontent.com/yawer-digital/games/refs/heads/main/sxsx.png" style="width:300px;">
    </div>

    <div class="top">
        <div><img src="https://github.com/yawer-digital/games/blob/main/coin.png?raw=true" style="width:18px;"><span id="balance">0</span></div>
        <div>üèÜ ÿßŸÑÿ±ÿ®ÿ≠: <span id="win">0</span></div>
    </div>


    <div class="reels" id="reels"></div>

    <button class="spin-btn" onclick="spin()">SPIN</button>

    <div class="bet-panel">
        <button onclick="changeBet(-10)"><img src="https://raw.githubusercontent.com/yawer-digital/games/refs/heads/main/sv2.png" style="width:35px;"></button>
        <div class="bet-value"><img src="https://github.com/yawer-digital/games/blob/main/coin.png?raw=true" style="width:18px;"><span id="bet">10</span></div>
        <button onclick="changeBet(10)"><img src="https://raw.githubusercontent.com/yawer-digital/games/refs/heads/main/sv1.png" style="width:35px;"></button>
    </div>

</div>

<script>
// ================== SYMBOLS ==================
const symbols = [
  {img:"https://raw.githubusercontent.com/yawer-digital/games/refs/heads/main/scx0.png", x:0},
  {img:"https://github.com/yawer-digital/games/blob/main/scx1.png?raw=true", x:1},
  {img:"https://github.com/yawer-digital/games/blob/main/scx2.png?raw=true", x:2},
  {img:"https://github.com/yawer-digital/games/blob/main/scx3.png?raw=true", x:3},
  {img:"https://github.com/yawer-digital/games/blob/main/scx5.png?raw=true", x:5},
  {img:"https://raw.githubusercontent.com/yawer-digital/games/refs/heads/main/scx8.png", x:8},
  {img:"https://raw.githubusercontent.com/yawer-digital/games/refs/heads/main/scx15.png", x:15},
  {img:"https://github.com/yawer-digital/games/blob/main/scx25.png?raw=true", x:25}
];

// ================== GAME CONFIG ==================
const reelsCount = 5;
const rows = 3;

let balance = 0;
let bet = 50;

// ================== ANDROID BRIDGE ==================
// Ÿäÿ≥ÿ™ŸÇÿ®ŸÑ ÿßŸÑÿ±ÿµŸäÿØ ŸÖŸÜ Android
function setBalanceFromAndroid(value){
  balance = Math.max(0, parseInt(value));
  updateBalance();
}

// ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ±ÿµŸäÿØ ÿ•ŸÑŸâ Android (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)
function sendBalanceToAndroid(){
  if(window.Android && Android.onBalanceChanged){
    Android.onBalanceChanged(balance);
  }
}

// ================== UI ==================
function updateBalance(){
  document.getElementById("balance").textContent = balance;
}

function updateBet(){
  document.getElementById("bet").textContent = bet;
}

// ================== REELS ==================
const reelsBox = document.getElementById("reels");

function createSymbol(){
  const s = document.createElement("div");
  s.className = "symbol";

  const sym = symbols[Math.floor(Math.random() * symbols.length)];
  const img = document.createElement("img");
  img.src = sym.img;
  img.dataset.mult = sym.x;

  s.appendChild(img);
  return s;
}

function init(){
  reelsBox.innerHTML = "";
  for(let i=0;i<reelsCount;i++){
    const reel = document.createElement("div");
    reel.className = "reel";

    const track = document.createElement("div");
    track.className = "track";

    for(let j=0;j<12;j++) track.appendChild(createSymbol());
    reel.appendChild(track);
    reelsBox.appendChild(reel);
  }
}
init();

// ================== BET ==================
function changeBet(v){
  bet = Math.max(10, Math.min(balance, bet + v));
  updateBet();
}

// ================== SPIN ==================
function spin(){
  if(balance < bet){
    alert("‚ùå ÿ±ÿµŸäÿØ ÿ∫Ÿäÿ± ŸÉÿßŸÅŸä");
    return;
  }

  balance -= bet;
  updateBalance();
  sendBalanceToAndroid();

  document.getElementById("win").textContent = 0;
  document.querySelectorAll(".symbol").forEach(s => s.classList.remove("win"));

  const tracks = document.querySelectorAll(".track");
  tracks.forEach(t => t.classList.add("spin"));

  tracks.forEach((track, i)=>{
    setTimeout(()=>{
      track.classList.remove("spin");
      track.classList.add("stop");
      track.innerHTML = "";

      for(let r=0;r<rows;r++) track.appendChild(createSymbol());
      setTimeout(()=>track.classList.remove("stop"),300);

      if(i === tracks.length - 1){
        setTimeout(checkWin, 350);
      }
    }, 600 + i * 350);
  });
}

// ================== WIN CHECK ==================
function checkWin(){
  const grid = [];
  document.querySelectorAll(".track").forEach((t,c)=>{
    [...t.children].forEach((s,r)=>{
      if(!grid[r]) grid[r] = [];
      grid[r][c] = s;
    });
  });

  let total = 0;

  for(let r=0;r<rows;r++){
    let count = 1;
    for(let c=1;c<reelsCount;c++){
      const a = grid[r][c-1].querySelector("img").src;
      const b = grid[r][c].querySelector("img").src;

      if(a === b){
        count++;
        if(count >= 3){
          const mult = parseInt(grid[r][c].querySelector("img").dataset.mult);
          total += bet * mult;

          for(let k=0;k<count;k++){
            grid[r][c-k].classList.add("win");
          }

          const effect = document.getElementById("winEffect");
          effect.classList.add("show");
          setTimeout(()=>effect.classList.remove("show"), 1600);
        }
      } else {
        count = 1;
      }
    }
  }

  if(total > 0){
    balance += total;
    updateBalance();
    sendBalanceToAndroid();
    document.getElementById("win").textContent = total;
  }
}

// ================== MUSIC ==================
let musicOn = false;
const music = document.getElementById("bgMusic");
const icon  = document.getElementById("musicIcon");

function toggleMusic(){
  if(musicOn){
    music.pause();
    icon.src = "https://cdn-icons-png.flaticon.com/512/727/727269.png";
  } else {
    music.play();
    icon.src = "https://cdn-icons-png.flaticon.com/512/727/727240.png";
  }
  musicOn = !musicOn;
}

// ================== INFO ==================
function openInfo(){
  document.getElementById("infoBox").style.display = "flex";
}
function closeInfo(){
  document.getElementById("infoBox").style.display = "none";
}

// ================== AUTO LOAD ANDROID BALANCE ==================
window.onload = () => {
  if(window.Android && Android.getBalanceFromApp){
    Android.getBalanceFromApp();
  }
};
</script>

</body>

<!-- MUSIC -->
<audio id="bgMusic" loop>
    <source src="music.mp3" type="audio/mpeg">
</audio>

<!-- INFO BOX -->
<div id="infoBox">
    <div id="infoContent">
        <h2>ŸÇŸàÿßÿπÿØ ÿßŸÑŸÑÿπÿ®ÿ©</h2>
        <p>
            ‚ñ™ 3 ÿ±ŸÖŸàÿ≤ ŸÖÿ™ÿ¥ÿßÿ®Ÿáÿ© ÿ£Ÿà ÿ£ŸÉÿ´ÿ± = ÿ±ÿ®ÿ≠<br>
            ‚ñ™ ŸÉŸÑ ÿ±ŸÖÿ≤ ŸÑŸá ŸÖÿ∂ÿßÿπŸÅ ŸÖÿÆÿ™ŸÑŸÅ<br>
            ‚ñ™ ŸÉŸÑŸÖÿß ÿ≤ÿßÿØ ÿßŸÑÿ±ŸáÿßŸÜ ÿ≤ÿßÿØ ÿßŸÑÿ±ÿ®ÿ≠
        </p>
        <button onclick="closeInfo()">ÿ•ÿ∫ŸÑÿßŸÇ</button>
    </div>
</div>

<!-- WIN EFFECT -->
<div id="winEffect">
    <img src="https://github.com/yawer-digital/games/blob/main/scx1.png?raw=true">
</div>

</html>
